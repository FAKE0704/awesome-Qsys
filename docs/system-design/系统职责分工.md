# 命名一致性
- 管理类：Manager后缀（RiskManager）
- 策略相关：Strategy后缀（PositionStrategy）
- 数据源：Source后缀（DataSource）
- 事件：无后缀（Stock/OrderEvent）



# src/core/data/database.py
## DatabaseManager
- 负责数据库连接池管理（asyncpg实现）
- 表结构初始化
- 股票数据CRUD操作
- 数据完整性检查

主要方法
- save_order：保存订单
- update_order_status：更新订单状态
- log_execution：交易执行结果日志记录
- record_trade：交易记录
- query_orders：订单队列
- query_trades：交易历史队列

待实现：
- 添加交易相关方法
```
async def save_order(self, order: dict) -> int:
        """异步保存订单"""
        async with self.pool.acquire() as conn:
            return await conn.fetchval("""
                INSERT INTO Orders (...) VALUES (...) RETURNING order_id
            """, ...)
```


- 

# src/core/data/data_source.py
## DataSourceError
- 数据源操作异常基类
## DataSource
- 数据源抽象基类

# src/core/data/data_factory.py
## DataFactory(DataSource)
- 数据源工厂类，实现单例模式和线程安全的数据源管理
### BaostockDataSource(DataSource)
- 已注册到数据源工厂
### AkShareSource(DataSource)
- 已注册到数据源工厂

# src/core/data/market_data_source.py
## DatabaseConnection(Protocal)
- 可能冗余
- 数据库连接协议
## MarketDataSource(DataSource)
市场数据源实现类

# src/core/data/stock.py
## Stock
- 股票类

# src/core/execution/Trader.py
## TradeOrderManager
- 负责订单生命周期管理（创建、修改、取消、状态跟踪）

## TradeExecutionEngine
- 负责执行底层操作（订单创建、修改、取消等）

## TradeRecorder
## BaseTrader
## BacktestTrader(BaseTrader)
## LiveTrader(BaseTrader)



# src/core/risk/risk_manager.py
## RiskManager
- 负责系统级风险控制（全局资金/仓位限额）
- 负责验证PositionStrategy的输出是否合规（风控）

主要方法
- validate_order：验证订单风险是否通过
- _check_funds：检查资金是否充足
- _check_position：检查是否超过仓位限制

问题：
- RiskManager直接访问`portfolio.get_position()`和`portfolio.get_strategy_limit()`
- 这可能导致RiskManager与Portfolio实现强耦合


# src/core/strategy/strategy.py
## BaseStrategy
## FixedInvestmentStrategy

# src/core/strategy/rule_parser.py
## IndicatorFunction
## RuleParser


# src/core/strategy/rule_based_strategy.py
## RuleBasedStrategy

# src/core/strategy/position_strategy.py
## PositionStrategy
仓位策略基类
- 负责策略层面的仓位计算


## FixedPercentStrategy(PositionStrategy)
固定比例仓位策略
- calculate_position：计算仓位比例
## KellyStrategy(PositionStrategy)
凯利公式仓位策略
- calculate_position：计算凯利公式仓位

# src/core/strategy/indicators.py
## IndicatorService

# src/core/strategy/dca_strategy.py
## DCABaseStrategy

# src/core/strategy/backtesting.py
## BacktestConfig
- 负责管理回测所需的所有参数配置
## BacktestEngine
- 负责执行回测流程

# src/core/portfolio/portfolio.py
## Portfolio

方法
- update_position：更新持仓
- get_portfolio_value：获取投资组合总价值
- 

# src/event_bus/handlers/strategy/strategy_handler.py
## StrategyEventHandler
- 策略事件处理
