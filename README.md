# 1. 量化交易系统项目
## 1.1. 项目概述
本项目是基于streamlit开发的量化交易系统,分为几个模块。
## 1.2. 项目文件夹路径
C:\Users\Thomas P Gao\Documents\personal\VSC\awesome-Qsys
## 1.3. 文件结构
awesome-Qsys/src/
├── core/                         # 核心模块
│   ├── data/                     # 数据模块
│   │   ├── database.py           # 数据库操作
│   ├── strategy/                 # 策略模块
│   │   ├── backtesting.py        # 回测功能
│   │   ├── strategy.py           # 策略实现
│   ├── execution/                # 执行模块
│   │   ├── Trader.py             # 交易执行
│   ├── risk/                     # 风险模块
├── frontend/                     # 前端模块
│   ├── drawer.py                 # 数据可视化
├── backend/                      # 后端模块
├── support/                      # 支持模块
│   ├── log/                      # 日志模块
│   ├── monitor/                  # 监控模块
├── venvQuant/                    # 虚拟环境文件夹
├── main.py                       # 项目主函数文件


## 1.4. 数据模块
功能：负责市场数据的获取、存储和预处理，支持多种数据源接入。
![1742906681628](image/README/1742906681628.png)

[Data Sources] → [Data Manager] → [Indicator Calculators]
       ↑                ↓
[Data Service] ← [Cache Layer]

### 1.4.1. Data类核心方法
- `load()`: 加载股票数据
- `update_data(data_end_date)`: 异步更新单个股票数据
- `get_sma(window)`: 计算简单移动平均线
- `get_macd(short_window, signal_window, long_window)`: 计算MACD指标
- `get_rsi(window)`: 计算相对强弱指数
- `delete()`: 删除当前数据
- `delete_last()`: 删除最后一行数据

### 1.4.2. BaostockDataSource类
功能：封装Baostock数据获取逻辑，支持异步数据加载和缓存

#### 1.4.2.1. 核心方法：
- `load_data(symbol, start_date, end_date, frequency)`: 异步加载股票数据
- `_transform_data(data)`: 标准化数据格式

### 1.4.3. 数据获取流程
1. 检查内存缓存
2. 检查磁盘缓存
3. 从Baostock API获取数据
4. 缓存新数据
5. 返回标准化后的数据

### 1.4.4. 数据库表
- Market_Data
- Trade_Records
- Positions
- Strategies
- Signals
- Accounts
- Fund_Flows
- Backtest_Results
- Risk_Management
- Logs

### 1.4.5. 数据格式标准化
- 统一时间字段格式
- 统一列名命名规范
- 处理缺失值和异常值

## 1.5. 策略模块 Strategy class
功能：定义和管理交易策略。
子模块：
策略模板：提供策略开发的基类和接口。
策略市场：存储和管理用户创建的策略。
策略回测：支持策略的历史回测功能。
## 1.6. 交易模块 Buyer class
功能：负责交易订单的生成和执行。
子模块：
订单管理：创建、修改、取消订单。
执行引擎：对接交易所 API，执行交易。
交易记录：记录所有交易细节。


## 1.7. 风险模块
功能：监控和管理交易风险。
子模块：
风险评估：计算风险指标（如 VaR、最大回撤等）。
风险控制：设置止损、止盈等规则。
风险报告：生成风险报告和警报。
# 2. 前端模块
## 2.1. 2.1 用户界面模块
功能：提供用户交互界面。
子模块：
仪表盘：展示关键指标和市场概况。
策略管理：允许用户创建、编辑和监控策略。
交易执行：提供交易订单的界面。
风险监控：展示风险指标和警报。
## 2.2. 2.2 数据可视化模块
功能：将数据和交易结果以可视化形式展示。
子模块：
K 线图：展示价格走势。
指标图：展示技术指标（如 MA、MACD 等）。
统计图表：展示交易统计结果。
## 2.3. 2.3 实时通信模块
功能：支持前端与后端的实时数据通信。
子模块：
WebSocket：处理实时市场数据和交易更新。
REST API：处理非实时请求。
# 3. 后端模块
## 3.1. 3.1 API 网关
功能：作为前端与核心模块之间的桥梁。
子模块：
路由管理：定义 API 路由。
请求处理：解析和处理前端请求。
响应格式化：将后端数据格式化为前端可读的格式。
## 3.2. 3.2 任务调度模块
功能：管理定时任务和异步任务。
子模块：
定时任务：如定期获取市场数据、更新策略等。
异步任务：如处理大量计算任务。
## 3.3. 3.3 认证授权模块
功能：管理用户认证和权限控制。
子模块：
用户认证：处理登录、注册等。
权限控制：定义用户角色和权限。
# 4. 支持模块
## 4.1. 4.1 日志模块
功能：记录系统运行日志和交易日志。
子模块：
日志记录：存储日志信息。
日志查询：提供日志查询接口。
## 4.2. 4.2 监控模块
功能：监控系统性能和状态。
子模块：
性能监控：监控 CPU、内存等资源使用情况。
健康检查：提供系统健康状态检查接口。
## 4.3. 4.3 通知模块
功能：发送通知和警报。
子模块：
邮件通知：发送交易确认、风险警报等邮件。
站内通知：提供站内消息系统。




# 5. 待更新
- [ ] streamlit rerun需要耗费大量时间重新计算数据,使用数据库
- [ ] 仔细检查回测思路
- [x] 买卖点绘制
- [ ] hover 参数
