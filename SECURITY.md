# 安全配置指南

## 🔐 数据库安全

### 敏感信息保护

**重要提醒**：请勿在代码中硬编码任何敏感信息（如数据库密码、API密钥等）。

### 环境变量配置

系统已配置为使用环境变量管理敏感信息：

1. **创建环境变量文件**：
   ```bash
   cp .env.example .env
   ```

2. **配置数据库连接**：
   ```env
   # 数据库配置
   DB_HOST=your_database_host
   DB_PORT=5432
   DB_NAME=your_database_name
   DB_USER=your_username
   DB_PASSWORD=your_secure_password
   ```

3. **确保安全**：
   - `.env` 文件已被添加到 `.gitignore`，不会被提交到版本控制
   - 在生产环境中，建议使用系统环境变量或安全的配置管理服务

### 数据库连接安全建议

1. **使用强密码**：
   - 密码长度至少12位
   - 包含大小写字母、数字和特殊字符
   - 避免使用常见词汇或个人信息

2. **网络隔离**：
   - 数据库服务器应部署在内网环境
   - 使用防火墙限制访问来源IP
   - 考虑使用VPN或SSH隧道访问

3. **定期轮换**：
   - 定期更换数据库密码
   - 监控数据库访问日志

## 🛡️ 数据源安全

### Baostock数据源
- 使用官方提供的免费API
- 不需要API密钥
- 遵守使用条款和频率限制

### AkShare数据源
- 部分数据源可能需要API密钥
- 请妥善保管API密钥
- 遵守各数据源的使用条款

## 🔒 代码安全实践

### 1. 避免硬编码
```python
# ❌ 不安全
class DatabaseManager:
    def __init__(self, host='113.45.40.20', password='quant123'):

# ✅ 安全
class DatabaseManager:
    def __init__(self, host=None, password=None):
        self.host = host or os.getenv('DB_HOST')
        self.password = password or os.getenv('DB_PASSWORD')
```

### 2. 输入验证
- 对所有用户输入进行验证
- 使用参数化查询防止SQL注入
- 验证数据类型和范围

### 3. 错误处理
- 避免在错误信息中泄露敏感信息
- 使用统一的错误处理机制
- 记录错误日志但不暴露内部细节

## 📋 部署安全检查清单

- [ ] 已创建并配置 `.env` 文件
- [ ] 数据库密码符合安全要求
- [ ] 数据库服务器网络访问受限
- [ ] 所有API密钥已妥善保管
- [ ] 代码中无硬编码的敏感信息
- [ ] 防火墙规则已正确配置
- [ ] 定期备份数据库
- [ ] 监控系统运行状态

## 🚨 紧急响应

如果发现安全漏洞或敏感信息泄露：

1. **立即更改密码**：
   - 数据库密码
   - 相关API密钥

2. **检查访问日志**：
   - 数据库访问日志
   - 系统安全日志

3. **通知相关人员**：
   - 系统管理员
   - 安全团队

4. **更新配置**：
   - 重新生成所有密钥
   - 更新环境变量

---

**安全第一**：请始终遵循最小权限原则，仅授予必要的访问权限。